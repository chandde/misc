{"version":3,"sources":["context.js","service.js","loginpage.js","homepage.js","registerpage.js","App.js","reportWebVitals.js","index.js"],"names":["SessionContext","React","createContext","ServiceHost","listFolder","userId","folderId","token","callback","errorcallback","xhr","XMLHttpRequest","onload","response","onerror","status","open","setRequestHeader","send","JSON","stringify","UserId","FolderId","LoginPage","useState","username","setusername","password","setpassword","authErr","setAuthErr","history","useHistory","context","useContext","loginCallback","decoded","jwt_decode","updateContext","userId","userName","folderId","rootfolderId","push","loginErrorCallback","to","className","onChange","e","target","value","type","Button","onClick","passwordStream","TextEncoder","encode","Promise","resolve","crypto","subtle","digest","then","hashBuffer","hashHex","Array","from","Uint8Array","map","b","toString","padStart","join","UserName","Password","Login","HomePage","files","setFiles","creatingFolder","setCreatingFolder","newFolderName","setNewFolderName","listCallback","list","parse","listErrorcallback","uploadCallback","globalContext","uploadErrorCallback","onFileChange","formData","FormData","_","each","file","append","name","UploadFiles","onDownload","blob","fileName","a","document","createElement","href","URL","createObjectURL","download","hidden","body","appendChild","click","openFile","fileType","fileId","fileId","filename","responseType","DownloadFile","getparentCallback","parentFolderId","console","log","length","id","multiple","GetParentFolder","Modal","show","Header","Title","Body","Footer","disabled","FileName","CreateFolder","sortBy","f","toLowerCase","RegisterPage","createAccountCallback","setusercreated","createAccountErrorCallback","errorcode","setusercreateerror","setUserName","password1","setPassword1","password2","setPassword2","usercreated","usercreateerror","CreateUser","undefined","App","getCookie","row","cookie","split","find","startsWith","setContext","Provider","newContext","defaults","path","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.8750be72.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nexport const SessionContext = React.createContext();\r\n","import _ from 'underscore';\r\n\r\nconst ServiceHost = \"https://localhost:44332/\";\r\n\r\nexport function CreateUser(username, password, callback, errorcallback) {\r\n    const xhr = new XMLHttpRequest();\r\n\r\n    // get a callback when the server responds\r\n    xhr.onload = callback;\r\n    xhr.onerror = () => errorcallback(xhr.status);\r\n    xhr.open('POST', `${ServiceHost}createuser`);\r\n    xhr.send({\r\n        UserName: username,\r\n        Password: password,\r\n    });\r\n};\r\n\r\nexport function Login(username, password, callback, errorcallback) {\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.onload = () => callback(xhr.response);\r\n    xhr.onerror = () => errorcallback(xhr.status);\r\n    xhr.open('POST', `${ServiceHost}authenticate`);\r\n    xhr.send(JSON.stringify({\r\n        UserName: username,\r\n        Password: password,\r\n    }));\r\n}\r\n\r\nexport function listFolder(userId, folderId, token, callback, errorcallback) {\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.onload = () => callback(xhr.response);\r\n    xhr.onerror = () => {\r\n        errorcallback(xhr.status);\r\n    }\r\n    xhr.open('POST', `${ServiceHost}listfolder`);\r\n    xhr.setRequestHeader('Authorization', `Bearer ${token}`);\r\n    xhr.send(JSON.stringify({\r\n        UserId: userId,\r\n        FolderId: folderId,\r\n    }));\r\n}\r\n\r\nexport function UploadFiles(userId, folderId, files, token, callback, errorcallback) {\r\n    const formData = new FormData();\r\n\r\n    // Update the formData object\r\n    _.each(files, file => formData.append(\r\n      \"file\",\r\n      file,\r\n      file.name\r\n    ));\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.onload = () => callback(xhr.response);\r\n    xhr.onerror = () => errorcallback(xhr.status);\r\n    xhr.open('POST', `${ServiceHost}uploadfile?userId=${userId}&folderId=${folderId}`);\r\n    xhr.setRequestHeader('Authorization', `Bearer ${token}`);\r\n    xhr.send(formData);\r\n};\r\n\r\nexport function DownloadFile(userId, fileId, filename, token, callback, errorcallback) {\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.onload = () => callback(xhr.response, filename);\r\n    xhr.onerror = () => errorcallback(xhr.status);\r\n    xhr.open('POST', `${ServiceHost}downloadfile?fileId=${fileId}`);\r\n    xhr.responseType = \"blob\";\r\n    xhr.setRequestHeader('Authorization', `Bearer ${token}`);\r\n    xhr.send(JSON.stringify({\r\n        UserId: userId,\r\n    }));\r\n}\r\n\r\nexport function CreateFolder(userId, folderId, newFolderName, token, callback, errorcallback) {\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.onload = () => callback(xhr.response);\r\n    xhr.onerror = () => errorcallback(xhr.status);\r\n    xhr.open('POST', `${ServiceHost}createfolder?folderName=${newFolderName}`);\r\n    xhr.setRequestHeader('Authorization', `Bearer ${token}`);\r\n    xhr.send(JSON.stringify({\r\n        UserId: userId,\r\n        FolderId: folderId,\r\n        FileName: newFolderName,\r\n    }));\r\n}\r\n\r\nexport function GetParentFolder(userId, folderId, token, callback, errorcallback) {\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.onload = () => callback(xhr.response);\r\n    xhr.onerror = () => errorcallback(xhr.status);\r\n    xhr.open('POST', `${ServiceHost}getparent`);\r\n    xhr.setRequestHeader('Authorization', `Bearer ${token}`);\r\n    xhr.send(JSON.stringify({\r\n        UserId: userId,\r\n        FolderId: folderId,\r\n    }));    \r\n}","\r\nimport { Redirect, Link } from 'react-router-dom';\r\nimport { Button } from 'react-bootstrap';\r\nimport { useContext, useState } from 'react';\r\nimport { useHistory } from \"react-router-dom\";\r\nimport jwt_decode from \"jwt-decode\";\r\nimport Promise from 'bluebird';\r\n\r\nimport { SessionContext } from './context';\r\nimport { Login } from './service';\r\n\r\nexport function LoginPage() {\r\n    const [username, setusername] = useState(null);\r\n    const [password, setpassword] = useState(null);\r\n    const [authErr, setAuthErr] = useState(false);\r\n\r\n    let history = useHistory();\r\n\r\n    const context = useContext(SessionContext)\r\n\r\n    const usernamechanged = (e) => {\r\n        setusername(e.target.value);\r\n    }\r\n\r\n    const passwordchanged = (e) => {\r\n        setpassword(e.target.value);\r\n    }\r\n\r\n    const loginCallback = (response) => {\r\n        if (response) {\r\n            var decoded = jwt_decode(response);\r\n            context.updateContext({\r\n                userId: decoded.userId,\r\n                userName: decoded.username,\r\n                folderId: decoded.rootfolderId,\r\n                token: response,                \r\n            });\r\n            history.push('/')\r\n            // parse JWT token and populate data into global context\r\n        } else {\r\n            setAuthErr(false);\r\n        }\r\n    };\r\n\r\n    const loginErrorCallback = (status) => {\r\n        setAuthErr(true);\r\n    };\r\n\r\n    const login = () => {\r\n        // hash password\r\n        const passwordStream = new TextEncoder().encode(password);\r\n        Promise.resolve(crypto.subtle.digest('SHA-256', passwordStream)).then(hashBuffer => {\r\n            const hashArray = Array.from(new Uint8Array(hashBuffer));                     // convert buffer to byte array\r\n            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join(''); // convert bytes to hex string\r\n            Login(username, hashHex, loginCallback, loginErrorCallback);\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <h1>Welcome to MyDrive, or your drive! Please log in</h1>\r\n            <h2>if you have not registered before, please register first</h2>\r\n            <Link to=\"/register\">Switch to register</Link>\r\n            <br />\r\n            <br />\r\n            <h2>User name</h2>\r\n            <input className=\"username\" onChange={usernamechanged} />\r\n            <h2>Password</h2>\r\n            <input className=\"password\" type=\"password\" onChange={passwordchanged} />\r\n            <Button onClick={login}>Login</Button>\r\n            {authErr && <div>Authentication failed, please try again</div>}\r\n        </div>\r\n    )\r\n};\r\n","/* eslint-disable jsx-a11y/anchor-is-valid */\r\nimport { Redirect } from 'react-router-dom';\r\nimport { useContext, useState } from 'react';\r\nimport { Button, Modal } from 'react-bootstrap';\r\nimport Promise from 'bluebird';\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nimport _ from 'underscore';\r\n\r\nimport { SessionContext } from './context';\r\nimport { listFolder, UploadFiles, DownloadFile, CreateFolder, GetParentFolder } from './service';\r\n\r\nexport function HomePage() {\r\n    const [files, setFiles] = useState(null);\r\n    const [creatingFolder, setCreatingFolder] = useState(false);\r\n    const [newFolderName, setNewFolderName] = useState(\"\");\r\n    let history = useHistory();\r\n\r\n    const listCallback = (response) => {\r\n        if (response) {\r\n            var list = JSON.parse(response);\r\n            setFiles(list);\r\n        }\r\n    };\r\n\r\n    const listErrorcallback = () => {\r\n        history.push('/login')\r\n    };\r\n\r\n    const uploadCallback = (response) => {\r\n        // on successful upload, call listFolder to reload the file list\r\n        listFolder(\r\n            context.globalContext.userId,\r\n            context.globalContext.folderId,\r\n            context.globalContext.token,\r\n            listCallback,\r\n            listErrorcallback\r\n        );\r\n    };\r\n\r\n    const uploadErrorCallback = () => {\r\n\r\n    };\r\n\r\n    const onCreateFolderClicks = () => {\r\n        setCreatingFolder(true);\r\n        setNewFolderName(\"\");\r\n    }\r\n\r\n    const context = useContext(SessionContext);\r\n\r\n    if (!files) {\r\n        if (!context.globalContext || !context.globalContext.userId) {\r\n            return <Redirect to=\"/login\" />;\r\n        } else {\r\n            listFolder(\r\n                context.globalContext.userId,\r\n                context.globalContext.folderId,\r\n                context.globalContext.token,\r\n                listCallback,\r\n                listErrorcallback\r\n            );\r\n        }\r\n    }\r\n\r\n    const onFileChange = (e) => {\r\n        // setSelectedFiles(e.target.files);\r\n        UploadFiles(\r\n            context.globalContext.userId,\r\n            context.globalContext.folderId,\r\n            e.target.files,\r\n            context.globalContext.token,\r\n            uploadCallback,\r\n            uploadErrorCallback\r\n        );\r\n    };\r\n\r\n    const onDownload = (blob, fileName ) => {\r\n        var a = document.createElement(\"a\");\r\n        a.href = URL.createObjectURL(blob);\r\n        a.download = fileName;\r\n        a.hidden = true;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n    }\r\n\r\n    const uploadFile = () => (<div>\r\n        <input type=\"file\" id=\"input\" multiple onChange={onFileChange} />\r\n        </div>\r\n    );\r\n\r\n    const openFile = (file) => {\r\n        if (file.fileType === \"Folder\") {\r\n            setFiles(null);\r\n            context.updateContext({\r\n                folderId: file.fileId\r\n            });\r\n        } else {\r\n            DownloadFile(context.globalContext.userId, file.fileId, file.fileName, context.globalContext.token, onDownload);\r\n        }\r\n    };\r\n\r\n    const creatingCancelClicked = () =>{\r\n        setCreatingFolder(false);\r\n        setNewFolderName(\"\");\r\n    }\r\n\r\n    const creatingOKClicked = () =>{\r\n        setCreatingFolder(false);   \r\n        CreateFolder(context.globalContext.userId, context.globalContext.folderId, newFolderName, context.globalContext.token, uploadCallback);\r\n    }\r\n\r\n    const getparentCallback = (parentFolderId) => {\r\n        setFiles(null);\r\n        context.updateContext({\r\n            folderId: parentFolderId\r\n        });                \r\n    }\r\n\r\n    const onGoUpClick = () => {\r\n        GetParentFolder(context.globalContext.userId, context.globalContext.folderId, context.globalContext.token, getparentCallback)\r\n    }\r\n\r\n    const newFolderNameUpdated = (e) => {\r\n        setNewFolderName(e.target.value);\r\n    }\r\n\r\n    const buildFileList = () => _.map(_.sortBy(files, f => f.fileName.toLowerCase()), file => (<div>\r\n        <a\r\n            className={file.fileType}\r\n            href={`javascript:void(0)`}\r\n            onClick={() => openFile(file)}\r\n        >\r\n            {`${file.fileType === \"Folder\" ? \"<<<Folder>>> \" : \"\"}${file.fileName}`}\r\n        </a>\r\n        <br />\r\n    </div>));\r\n\r\n    console.log(files);\r\n\r\n    return (\r\n        <div>\r\n            {(!files || files.length === 0)  && \r\n                <div>Seems you don't have anything here...</div>\r\n            }\r\n            <br/>            \r\n            {uploadFile()}\r\n            <br/>\r\n            <Button onClick={onCreateFolderClicks}>Create folder</Button>\r\n            <Button onClick={onGoUpClick}>Go up</Button>\r\n            <Modal show={creatingFolder}>\r\n                <Modal.Header>\r\n                    <Modal.Title>Please enter new folder name:</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    <input className=\"newFolderName\" onChange={newFolderNameUpdated} />\r\n                </Modal.Body>\r\n                <Modal.Footer>\r\n                    <Button className=\"creatingOK\" disabled={newFolderName.length === 0} onClick={creatingOKClicked}>OK</Button>\r\n                    <Button className=\"creatingCancel\" onClick={creatingCancelClicked}>Cancel</Button>\r\n                </Modal.Footer>\r\n            </Modal>\r\n            <br/>\r\n            { (files && files.length > 0) && \r\n                buildFileList()\r\n            }\r\n        </div>\r\n    );\r\n};\r\n","\r\nimport { Redirect, Link } from 'react-router-dom';\r\nimport { useContext, useState } from 'react';\r\nimport { Button } from 'react-bootstrap';\r\nimport { SessionContext } from './context';\r\nimport { CreateUser } from './service';\r\n\r\nimport Promise from 'bluebird';\r\n\r\nexport function RegisterPage() {\r\n    const createAccount = () => {\r\n        // hash password\r\n        const passwordStream = new TextEncoder().encode(password1);\r\n        Promise.resolve(crypto.subtle.digest('SHA-256', passwordStream)).then(hashBuffer => {\r\n            const hashArray = Array.from(new Uint8Array(hashBuffer));                     // convert buffer to byte array\r\n            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join(''); // convert bytes to hex string\r\n            CreateUser(userName, hashHex, createAccountCallback, createAccountErrorCallback);\r\n        });\r\n    };\r\n\r\n    const createAccountCallback = () => {\r\n        setusercreated(true);\r\n    };\r\n\r\n    const createAccountErrorCallback = (errorcode) => {\r\n        setusercreateerror(errorcode);\r\n    }\r\n\r\n    const usernamechanged = (e) => {\r\n        setUserName(e.target.value);\r\n    };\r\n\r\n    const password1changed = (e) => {\r\n        setPassword1(e.target.value);\r\n    };\r\n\r\n    const password2changed = (e) => {\r\n        setPassword2(e.target.value);\r\n    };\r\n\r\n    const [userName, setUserName] = useState(null);\r\n    const [password1, setPassword1] = useState(null);\r\n    const [password2, setPassword2] = useState(null);\r\n    const [usercreated, setusercreated] = useState(false);\r\n    const [usercreateerror, setusercreateerror] = useState(null);\r\n\r\n    return (\r\n        <div>\r\n            <h1>Register MyDrive account here</h1>\r\n            <br />\r\n            <h2>User name</h2>\r\n            <input className=\"username\" onChange={usernamechanged} />\r\n            <h2>Password</h2>\r\n            <input className=\"password\" type=\"password\" onChange={password1changed} />\r\n            <h2>Repeat password</h2>\r\n            <input className=\"password2\" type=\"password\" onChange={password2changed} />\r\n            <br />\r\n            {password1 !== password2 &&\r\n                <div className=\"passwordunmatch\" >passwords don't match</div>\r\n            }\r\n            <Button disabled={!password1 || !password2 || password1 !== password2} onClick={createAccount}>Create account</Button>\r\n\r\n            {usercreated &&\r\n                <div><h2>Your account has been created successfully, please log in<Link to=\"/login\">Login</Link></h2>\r\n                </div>\r\n            }\r\n\r\n            {usercreateerror !== null && usercreateerror !== undefined && \r\n                <div><h2>Something went wrong, please try again</h2>\r\n                </div>}\r\n        </div>);\r\n};","import './App.css';\nimport React, { useContext, useState } from 'react';\nimport { Switch, Route, BrowserRouter as Router } from 'react-router-dom';\nimport _ from 'underscore';\n\nimport { SessionContext } from './context';\nimport { LoginPage } from './loginpage';\nimport { HomePage } from './homepage';\nimport { RegisterPage } from './registerpage';\n\nfunction App() {\n  const getCookie = (name) => {\n    const row = document.cookie\n      .split('; ')\n      .find(row => row.startsWith(name));\n\n    if (row) {\n      return row.split('=')[1];\n    }\n  };\n\n  const userId = getCookie(\"userId\");\n  const folderId = getCookie(\"folderId\");\n  const token = getCookie(\"jwttokencookie\");\n  const userName = getCookie(\"username\");\n\n  const [context, setContext] = useState({\n    userId,\n    userName,\n    folderId,\n    token,\n  });\n\n  const updateContext = (newContext) => {\n    setContext(_.defaults(newContext, context));\n  };\n\n  return (\n    <SessionContext.Provider value={{ globalContext: context, updateContext }}>\n      <Router>\n        <Route path=\"/\">\n          <HomePage />\n        </Route>\n        <Route path=\"/login\">\n          <LoginPage />\n        </Route>\n        <Route path=\"/register\">\n          <RegisterPage />\n        </Route>\n      </Router>\n    </SessionContext.Provider>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}