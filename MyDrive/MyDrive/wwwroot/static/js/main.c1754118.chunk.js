(this.webpackJsonpmydriveweb=this.webpackJsonpmydriveweb||[]).push([[0],{30:function(e,t,n){},31:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var r=n(2),o=n(0),c=n.n(o),a=n(22),s=n.n(a),i=(n(30),n(5)),u=(n(31),n(10)),l=n(4),d=n(11),j=c.a.createContext(),b=n(42),f=n(23),O=n(13),h=n.n(O),x="https://localhost:44370/";function p(e,t,n,r,o){var c=new XMLHttpRequest;c.onload=function(){return r(c.response)},c.onerror=function(){o(c.status)},c.open("POST","".concat(x,"listfolder")),c.setRequestHeader("Authorization","Bearer ".concat(n)),c.send(JSON.stringify({UserId:e,FolderId:t}))}function g(){var e=Object(o.useState)(null),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(o.useState)(null),s=Object(i.a)(a,2),d=s[0],O=s[1],p=Object(o.useState)(!1),g=Object(i.a)(p,2),v=g[0],m=g[1],C=Object(l.f)(),w=Object(o.useContext)(j),S=function(e){if(e){var t=Object(f.a)(e);w.updateContext({userId:t.userid,userName:t.username,folderId:t.rootfolderid,token:e}),C.push("/")}else m(!1)},y=function(e){m(!0)};return Object(r.jsxs)("div",{children:[Object(r.jsx)("h1",{children:"Welcome to MyDrive, or your drive! Please log in"}),Object(r.jsx)("h2",{children:"if you have not registered before, please register first"}),Object(r.jsx)(u.b,{to:"/register",children:"Switch to register"}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("h2",{children:"User name"}),Object(r.jsx)("input",{className:"username",onChange:function(e){c(e.target.value)}}),Object(r.jsx)("h2",{children:"Password"}),Object(r.jsx)("input",{className:"password",type:"password",onChange:function(e){O(e.target.value)}}),Object(r.jsx)(b.a,{onClick:function(){var e=(new TextEncoder).encode(d);h.a.resolve(crypto.subtle.digest("SHA-256",e)).then((function(e){var t=Array.from(new Uint8Array(e)).map((function(e){return e.toString(16).padStart(2,"0")})).join("");!function(e,t,n,r){var o=new XMLHttpRequest;o.onload=function(){return n(o.response)},o.onerror=function(){return r(o.status)},o.open("POST","".concat(x,"authenticate")),o.send(JSON.stringify({UserName:e,Password:t}))}(n,t,S,y)}))},children:"Login"}),v&&Object(r.jsx)("div",{children:"Authentication failed, please try again"})]})}function v(){var e=Object(o.useState)(null),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(l.f)(),s=function(e){if(e){var t=JSON.parse(e);c(t)}},u=function(){a.push("/login")},f=function(e){p(h.globalContext.userId,h.globalContext.folderId,h.globalContext.token,s,u)},O=function(){},h=Object(o.useContext)(j);if(!n){if(!h.globalContext||!h.globalContext.userId)return Object(r.jsx)(l.a,{to:"/login"});p(h.globalContext.userId,h.globalContext.folderId,h.globalContext.token,s,u)}var g=function(e){!function(e,t,n,r,o,c){var a=new FormData;d.a.each(n,(function(e){return a.append("file",e,e.name)}));var s=new XMLHttpRequest;s.onload=function(){return o(s.response)},s.onerror=function(){return c(s.status)},s.open("POST","".concat(x,"uploadfile?userid=").concat(e,"&folderid=").concat(t)),s.setRequestHeader("Authorization","Bearer ".concat(r)),s.send(a)}(h.globalContext.userId,h.globalContext.folderId,e.target.files,h.globalContext.token,f,O)};return console.log(n),Object(r.jsxs)("div",{children:[(!n||0===n.length)&&Object(r.jsx)("div",{children:"Seems you don't have anything here..."}),Object(r.jsx)("br",{}),Object(r.jsx)("div",{children:Object(r.jsx)("input",{type:"file",id:"input",multiple:!0,onChange:g})}),Object(r.jsx)("br",{}),Object(r.jsx)(b.a,{onClick:function(){},children:"Create folder"}),Object(r.jsx)("br",{}),n&&n.length>0&&d.a.map(n,(function(e){return Object(r.jsx)("div",{className:e.fileType,children:"".concat("Folder"===e.fileType?"+ ":"").concat(e.fileName)})}))]})}function m(){var e=function(){S(!0)},t=function(e){k(e)},n=Object(o.useState)(null),c=Object(i.a)(n,2),a=c[0],s=c[1],l=Object(o.useState)(null),d=Object(i.a)(l,2),j=d[0],f=d[1],O=Object(o.useState)(null),p=Object(i.a)(O,2),g=p[0],v=p[1],m=Object(o.useState)(!1),C=Object(i.a)(m,2),w=C[0],S=C[1],y=Object(o.useState)(null),I=Object(i.a)(y,2),N=I[0],k=I[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)("h1",{children:"Register MyDrive account here"}),Object(r.jsx)("br",{}),Object(r.jsx)("h2",{children:"User name"}),Object(r.jsx)("input",{className:"username",onChange:function(e){s(e.target.value)}}),Object(r.jsx)("h2",{children:"Password"}),Object(r.jsx)("input",{className:"password",type:"password",onChange:function(e){f(e.target.value)}}),Object(r.jsx)("h2",{children:"Repeat password"}),Object(r.jsx)("input",{className:"password2",type:"password",onChange:function(e){v(e.target.value)}}),Object(r.jsx)("br",{}),j!==g&&Object(r.jsx)("div",{className:"passwordunmatch",children:"passwords don't match"}),Object(r.jsx)(b.a,{disabled:!j||!g||j!==g,onClick:function(){var n=(new TextEncoder).encode(j);h.a.resolve(crypto.subtle.digest("SHA-256",n)).then((function(n){var r=Array.from(new Uint8Array(n)).map((function(e){return e.toString(16).padStart(2,"0")})).join("");!function(e,t,n,r){var o=new XMLHttpRequest;o.onload=n,o.onerror=function(){return r(o.status)},o.open("POST","".concat(x,"createuser")),o.send({UserName:e,Password:t})}(a,r,e,t)}))},children:"Create account"}),w&&Object(r.jsx)("div",{children:Object(r.jsxs)("h2",{children:["Your account has been created successfully, please log in",Object(r.jsx)(u.b,{to:"/login",children:"Login"})]})}),null!==N&&void 0!==N&&Object(r.jsx)("div",{children:Object(r.jsx)("h2",{children:"Something went wrong, please try again"})})]})}var C=function(){var e=function(e){return document.cookie.split("; ").find((function(t){return t.startsWith(e)})).split("=")[1]},t=e("userid"),n=e("folderid"),c=e("jwttokencookie"),a=e("username"),s=Object(o.useState)({userId:t,userName:a,folderId:n,token:c}),b=Object(i.a)(s,2),f=b[0],O=b[1];return Object(r.jsx)(j.Provider,{value:{globalContext:f,updateContext:function(e){O(d.a.defaults(e,f))}},children:Object(r.jsxs)(u.a,{children:[Object(r.jsx)(l.b,{path:"/",children:Object(r.jsx)(v,{})}),Object(r.jsx)(l.b,{path:"/login",children:Object(r.jsx)(g,{})}),Object(r.jsx)(l.b,{path:"/register",children:Object(r.jsx)(m,{})})]})})},w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,43)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,c=t.getLCP,a=t.getTTFB;n(e),r(e),o(e),c(e),a(e)}))};s.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(C,{})}),document.getElementById("root")),w()}},[[41,1,2]]]);
//# sourceMappingURL=main.c1754118.chunk.js.map