(this.webpackJsonpmydriveweb=this.webpackJsonpmydriveweb||[]).push([[0],{33:function(e,t,n){},34:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n(0),c=n.n(o),a=n(14),s=n.n(a),i=(n(33),n(9)),l=(n(34),n(13)),u=n(6),d=n(15),j=c.a.createContext(),b=n(48),f=n(25),O=n(17),h=n.n(O),x="https://192.168.1.78:44332/";function p(e,t,n,r,o){var c=new XMLHttpRequest;c.onload=function(){return r(c.response)},c.onerror=function(){o(c.status)},c.open("POST","".concat(x,"listfolder")),c.setRequestHeader("Authorization","Bearer ".concat(n)),c.send(JSON.stringify({UserId:e,FolderId:t}))}function g(){var e=Object(o.useState)(null),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(o.useState)(null),s=Object(i.a)(a,2),d=s[0],O=s[1],p=Object(o.useState)(!1),g=Object(i.a)(p,2),v=g[0],C=g[1],m=Object(u.f)(),w=Object(o.useContext)(j),S=function(e){if(e){var t=Object(f.a)(e);w.updateContext({userId:t.userId,userName:t.username,folderId:t.rootfolderId,token:e}),m.push("/")}else C(!1)},I=function(e){C(!0)};return Object(r.jsxs)("div",{children:[Object(r.jsx)("h1",{children:"Welcome to MyDrive, or your drive! Please log in"}),Object(r.jsx)("h2",{children:"if you have not registered before, please register first"}),Object(r.jsx)(l.b,{to:"/register",children:"Switch to register"}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("h2",{children:"User name"}),Object(r.jsx)("input",{className:"username",onChange:function(e){c(e.target.value)}}),Object(r.jsx)("h2",{children:"Password"}),Object(r.jsx)("input",{className:"password",type:"password",onChange:function(e){O(e.target.value)}}),Object(r.jsx)(b.a,{onClick:function(){var e=(new TextEncoder).encode(d);h.a.resolve(crypto.subtle.digest("SHA-256",e)).then((function(e){var t=Array.from(new Uint8Array(e)).map((function(e){return e.toString(16).padStart(2,"0")})).join("");!function(e,t,n,r){var o=new XMLHttpRequest;o.onload=function(){return n(o.response)},o.onerror=function(){return r(o.status)},o.open("POST","".concat(x,"authenticate")),o.send(JSON.stringify({UserName:e,Password:t}))}(n,t,S,I)}))},children:"Login"}),v&&Object(r.jsx)("div",{children:"Authentication failed, please try again"})]})}var v=n(47);function C(){var e=Object(o.useState)(null),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(o.useState)(!1),s=Object(i.a)(a,2),l=s[0],f=s[1],O=Object(o.useState)(""),h=Object(i.a)(O,2),g=h[0],C=h[1],m=Object(u.f)(),w=function(e){if(e){var t=JSON.parse(e);c(t)}},S=function(){m.push("/login")},I=function(e){p(N.globalContext.userId,N.globalContext.folderId,N.globalContext.token,w,S)},y=function(){},N=Object(o.useContext)(j);if(!n){if(!N.globalContext||!N.globalContext.userId)return Object(r.jsx)(u.a,{to:"/login"});p(N.globalContext.userId,N.globalContext.folderId,N.globalContext.token,w,S)}var k=function(e){!function(e,t,n,r,o,c){var a=new FormData;d.a.each(n,(function(e){return a.append("file",e,e.name)}));var s=new XMLHttpRequest;s.onload=function(){return o(s.response)},s.onerror=function(){return c(s.status)},s.open("POST","".concat(x,"uploadfile?userId=").concat(e,"&folderId=").concat(t)),s.setRequestHeader("Authorization","Bearer ".concat(r)),s.send(a)}(N.globalContext.userId,N.globalContext.folderId,e.target.files,N.globalContext.token,I,y)},P=function(e,t){var n=document.createElement("a");n.href=URL.createObjectURL(e),n.download=t,n.hidden=!0,document.body.appendChild(n),n.click()},R=function(e){"Folder"===e.fileType?(c(null),N.updateContext({folderId:e.fileId})):function(e,t,n,r,o,c){var a=new XMLHttpRequest;a.onload=function(){return o(a.response,n)},a.onerror=function(){return c(a.status)},a.open("POST","".concat(x,"downloadfile?fileId=").concat(t)),a.responseType="blob",a.setRequestHeader("Authorization","Bearer ".concat(r)),a.send(JSON.stringify({UserId:e}))}(N.globalContext.userId,e.fileId,e.fileName,N.globalContext.token,P)},T=function(e){e&&e.length>0&&(c(null),N.updateContext({folderId:e}))};return console.log(n),Object(r.jsxs)("div",{children:[(!n||0===n.length)&&Object(r.jsx)("div",{children:"Seems you don't have anything here..."}),Object(r.jsx)("br",{}),Object(r.jsx)("div",{children:Object(r.jsx)("input",{type:"file",id:"input",multiple:!0,onChange:k})}),Object(r.jsx)("br",{}),Object(r.jsx)(b.a,{onClick:function(){f(!0),C("")},children:"Create folder"}),Object(r.jsx)(b.a,{onClick:function(){!function(e,t,n,r,o){var c=new XMLHttpRequest;c.onload=function(){return r(c.response)},c.onerror=function(){return o(c.status)},c.open("POST","".concat(x,"getparent")),c.setRequestHeader("Authorization","Bearer ".concat(n)),c.send(JSON.stringify({UserId:e,FolderId:t}))}(N.globalContext.userId,N.globalContext.folderId,N.globalContext.token,T)},children:"Go up"}),Object(r.jsxs)(v.a,{show:l,children:[Object(r.jsx)(v.a.Header,{children:Object(r.jsx)(v.a.Title,{children:"Please enter new folder name:"})}),Object(r.jsx)(v.a.Body,{children:Object(r.jsx)("input",{className:"newFolderName",onChange:function(e){C(e.target.value)}})}),Object(r.jsxs)(v.a.Footer,{children:[Object(r.jsx)(b.a,{className:"creatingOK",disabled:0===g.length,onClick:function(){f(!1),function(e,t,n,r,o,c){var a=new XMLHttpRequest;a.onload=function(){return o(a.response)},a.onerror=function(){return c(a.status)},a.open("POST","".concat(x,"createfolder?folderName=").concat(n)),a.setRequestHeader("Authorization","Bearer ".concat(r)),a.send(JSON.stringify({UserId:e,FolderId:t,FileName:n}))}(N.globalContext.userId,N.globalContext.folderId,g,N.globalContext.token,I)},children:"OK"}),Object(r.jsx)(b.a,{className:"creatingCancel",onClick:function(){f(!1),C("")},children:"Cancel"})]})]}),Object(r.jsx)("br",{}),n&&n.length>0&&d.a.map(d.a.sortBy(n,(function(e){return e.fileName.toLowerCase()})),(function(e){return Object(r.jsxs)("div",{children:[Object(r.jsx)("a",{className:e.fileType,href:"javascript:void(0)",onClick:function(){return R(e)},children:"".concat("Folder"===e.fileType?"<<<Folder>>> ":"").concat(e.fileName)}),Object(r.jsx)("br",{})]})}))]})}function m(){var e=function(){S(!0)},t=function(e){k(e)},n=Object(o.useState)(null),c=Object(i.a)(n,2),a=c[0],s=c[1],u=Object(o.useState)(null),d=Object(i.a)(u,2),j=d[0],f=d[1],O=Object(o.useState)(null),p=Object(i.a)(O,2),g=p[0],v=p[1],C=Object(o.useState)(!1),m=Object(i.a)(C,2),w=m[0],S=m[1],I=Object(o.useState)(null),y=Object(i.a)(I,2),N=y[0],k=y[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)("h1",{children:"Register MyDrive account here"}),Object(r.jsx)("br",{}),Object(r.jsx)("h2",{children:"User name"}),Object(r.jsx)("input",{className:"username",onChange:function(e){s(e.target.value)}}),Object(r.jsx)("h2",{children:"Password"}),Object(r.jsx)("input",{className:"password",type:"password",onChange:function(e){f(e.target.value)}}),Object(r.jsx)("h2",{children:"Repeat password"}),Object(r.jsx)("input",{className:"password2",type:"password",onChange:function(e){v(e.target.value)}}),Object(r.jsx)("br",{}),j!==g&&Object(r.jsx)("div",{className:"passwordunmatch",children:"passwords don't match"}),Object(r.jsx)(b.a,{disabled:!j||!g||j!==g,onClick:function(){var n=(new TextEncoder).encode(j);h.a.resolve(crypto.subtle.digest("SHA-256",n)).then((function(n){var r=Array.from(new Uint8Array(n)).map((function(e){return e.toString(16).padStart(2,"0")})).join("");!function(e,t,n,r){var o=new XMLHttpRequest;o.onload=n,o.onerror=function(){return r(o.status)},o.open("POST","".concat(x,"createuser")),o.send(JSON.stringify({UserName:e,Password:t}))}(a,r,e,t)}))},children:"Create account"}),w&&Object(r.jsx)("div",{children:Object(r.jsxs)("h2",{children:["Your account has been created successfully, please log in",Object(r.jsx)(l.b,{to:"/login",children:"Login"})]})}),null!==N&&void 0!==N&&Object(r.jsx)("div",{children:Object(r.jsx)("h2",{children:"Something went wrong, please try again"})})]})}var w=function(){var e=function(e){var t=document.cookie.split("; ").find((function(t){return t.startsWith(e)}));if(t)return t.split("=")[1]},t=e("userId"),n=e("folderId"),c=e("jwttokencookie"),a=e("username"),s=Object(o.useState)({userId:t,userName:a,folderId:n,token:c}),b=Object(i.a)(s,2),f=b[0],O=b[1];return Object(r.jsx)(j.Provider,{value:{globalContext:f,updateContext:function(e){O(d.a.defaults(e,f))}},children:Object(r.jsxs)(l.a,{children:[Object(r.jsx)(u.b,{path:"/",children:Object(r.jsx)(C,{})}),Object(r.jsx)(u.b,{path:"/login",children:Object(r.jsx)(g,{})}),Object(r.jsx)(u.b,{path:"/register",children:Object(r.jsx)(m,{})})]})})},S=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,49)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,c=t.getLCP,a=t.getTTFB;n(e),r(e),o(e),c(e),a(e)}))};s.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(w,{})}),document.getElementById("root")),S()}},[[45,1,2]]]);
//# sourceMappingURL=main.0a8ec28f.chunk.js.map